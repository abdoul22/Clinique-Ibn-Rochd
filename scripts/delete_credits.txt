// =================================================================
// SCRIPT TINKER - Suppression TOTALE des crÃ©dits
// Copiez-collez directement dans: php artisan tinker
// ATTENTION: Supprime TOUS les crÃ©dits et leurs dÃ©penses liÃ©es !
// =================================================================

echo "=== AVANT SUPPRESSION ===";
echo "\nCrÃ©dits: " . \App\Models\Credit::count();
echo "\nDÃ©penses liÃ©es aux crÃ©dits: " . \App\Models\Depense::whereNotNull('credit_id')->count();

// RÃ©cupÃ©rer les statistiques par type
$creditsPersonnel = \App\Models\Credit::where('source_type', 'App\Models\Personnel')->count();
$creditsAssurance = \App\Models\Credit::where('source_type', 'App\Models\Assurance')->count();

echo "\nCrÃ©dits personnel: " . $creditsPersonnel;
echo "\nCrÃ©dits assurance: " . $creditsAssurance;

// Ã‰tape 1: Supprimer toutes les dÃ©penses liÃ©es aux crÃ©dits
$depensesDeleted = \App\Models\Depense::whereNotNull('credit_id')->count();
\App\Models\Depense::whereNotNull('credit_id')->delete();
echo "\nğŸ—‘ï¸ DÃ©penses liÃ©es supprimÃ©es: " . $depensesDeleted;

// Ã‰tape 2: Supprimer tous les crÃ©dits
$creditsDeleted = \App\Models\Credit::count();
\App\Models\Credit::query()->delete();
echo "\nğŸ—‘ï¸ CrÃ©dits supprimÃ©s: " . $creditsDeleted;

echo "\n=== APRÃˆS SUPPRESSION ===";
echo "\nCrÃ©dits: " . \App\Models\Credit::count();
echo "\nDÃ©penses liÃ©es aux crÃ©dits: " . \App\Models\Depense::whereNotNull('credit_id')->count();

// VÃ©rifier que les autres modules sont prÃ©servÃ©s
echo "\n=== MODULES PRÃ‰SERVÃ‰S ===";
echo "\nPersonnels: " . \App\Models\Personnel::count();
echo "\nAssurances: " . \App\Models\Assurance::count();
echo "\nPatients: " . \App\Models\GestionPatient::count();
echo "\nAutres dÃ©penses: " . \App\Models\Depense::whereNull('credit_id')->count();

echo "\nâœ… SUPPRESSION TERMINÃ‰E !";

// Note: Les crÃ©dits des personnels et assurances seront recalculÃ©s automatiquement
echo "\nğŸ“ Note: Les montants de crÃ©dit seront recalculÃ©s au prochain accÃ¨s aux profils";










